@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix guidance: <./guidance#> .
@prefix secrets: <./secrets_management#> .
@prefix meta: <./meta#> .
@prefix metameta: <./metameta#> .
@prefix problem: <./problem#> .
@prefix solution: <./solution#> .
@prefix conversation: <./conversation#> .

secrets:SecretsManagementOntology rdf:type owl:Ontology ;
    rdfs:label "Secrets Management Ontology" ;
    rdfs:comment "Ontology for managing secrets using 1Password and environment variables" ;
    owl:versionInfo "1.0.0" ;
    owl:imports <./guidance> .

# Core Classes
secrets:SecretsManagementPattern rdf:type owl:Class ;
    rdfs:label "Secrets Management Pattern" ;
    rdfs:subClassOf guidance:BestPractice ;
    rdfs:comment "Pattern for managing secrets across the system" .

secrets:SecretStore rdf:type owl:Class ;
    rdfs:label "Secret Store" ;
    rdfs:comment "A system for storing secrets" .

secrets:SecretReference rdf:type owl:Class ;
    rdfs:label "Secret Reference" ;
    rdfs:comment "A reference to a secret in code or configuration" .

# Properties
secrets:hasSecretStore rdf:type owl:ObjectProperty ;
    rdfs:label "has secret store" ;
    rdfs:domain secrets:SecretsManagementPattern ;
    rdfs:range secrets:SecretStore .

secrets:usesReferenceFormat rdf:type owl:DatatypeProperty ;
    rdfs:label "uses reference format" ;
    rdfs:domain secrets:SecretReference ;
    rdfs:range xsd:string .

# Instances
secrets:OnePassword rdf:type owl:NamedIndividual, secrets:SecretStore ;
    rdfs:label "1Password" ;
    rdfs:comment "1Password secret management system" .

secrets:EnvironmentVariable rdf:type owl:NamedIndividual, secrets:SecretReference ;
    rdfs:label "Environment Variable" ;
    rdfs:comment "Environment variable reference to a secret" ;
    secrets:usesReferenceFormat "${VARIABLE_NAME}" .

secrets:OnePasswordEnvPattern rdf:type owl:NamedIndividual, secrets:SecretsManagementPattern ;
    rdfs:label "1Password Environment Variable Pattern" ;
    secrets:hasSecretStore secrets:OnePassword ;
    guidance:sourceContext "Secret Management" ;
    guidance:targetContext "Application Configuration" ;
    guidance:complexity "2"^^xsd:integer ;
    rdfs:comment """Best practices for 1Password and environment variables:
1. Store all secrets in 1Password vaults
2. Use .env.example files to document required variables
3. Use ${VARIABLE_NAME} format in configuration files
4. Never commit .env files
5. Use 1Password CLI for automated secret injection
6. Document secret rotation procedures
7. Maintain clear secret naming conventions""" .

# SHACL Validation
secrets:SecretsManagementShape rdf:type sh:NodeShape ;
    sh:targetClass secrets:SecretsManagementPattern ;
    sh:property [
        sh:path secrets:hasSecretStore ;
        sh:minCount 1 ;
        sh:message "Must specify a secret store"
    ] ;
    sh:property [
        sh:path guidance:sourceContext ;
        sh:minCount 1 ;
        sh:message "Must specify source context"
    ] ;
    sh:property [
        sh:path guidance:targetContext ;
        sh:minCount 1 ;
        sh:message "Must specify target context"
    ] . 