{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Security Vulnerability Schema",
    "description": "Schema for security vulnerability data from various scanners",
    "type": "object",
    "properties": {
        "vulnerabilities": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "package_name": {
                        "type": "string",
                        "description": "Name of the affected package"
                    },
                    "CVE": {
                        "type": "string",
                        "description": "CVE identifier"
                    },
                    "vulnerability_id": {
                        "type": "string",
                        "description": "Alternative vulnerability identifier when CVE is not available"
                    },
                    "advisory": {
                        "type": "string",
                        "description": "Description of the vulnerability"
                    },
                    "severity": {
                        "type": "string",
                        "enum": [
                            "Critical",
                            "High",
                            "Medium",
                            "Low",
                            "Unknown"
                        ],
                        "description": "Severity level of the vulnerability"
                    },
                    "vulnerable_spec": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "Version specifications affected by the vulnerability"
                    },
                    "fixed_versions": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "Versions where the vulnerability is fixed"
                    },
                    "cvss_score": {
                        "type": "number",
                        "minimum": 0,
                        "maximum": 10,
                        "description": "CVSS score of the vulnerability"
                    },
                    "mitigation": {
                        "type": "string",
                        "description": "Mitigation status or recommendations"
                    }
                },
                "required": [
                    "package_name",
                    "severity"
                ],
                "anyOf": [
                    {
                        "required": [
                            "CVE"
                        ]
                    },
                    {
                        "required": [
                            "vulnerability_id"
                        ]
                    }
                ]
            }
        },
        "dependencies": {
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "type": "string",
                        "description": "Package name"
                    },
                    "vulnerabilities": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "id": {
                                    "type": "string",
                                    "description": "Vulnerability identifier"
                                },
                                "description": {
                                    "type": "string",
                                    "description": "Description of the vulnerability"
                                },
                                "severity": {
                                    "type": "string",
                                    "enum": [
                                        "Critical",
                                        "High",
                                        "Medium",
                                        "Low",
                                        "Unknown"
                                    ],
                                    "description": "Severity level of the vulnerability"
                                },
                                "affected_versions": {
                                    "type": "array",
                                    "items": {
                                        "type": "string"
                                    },
                                    "description": "Affected package versions"
                                },
                                "fixed_version": {
                                    "type": "string",
                                    "description": "Version where the vulnerability is fixed"
                                },
                                "cvss_score": {
                                    "type": "number",
                                    "minimum": 0,
                                    "maximum": 10,
                                    "description": "CVSS score of the vulnerability"
                                }
                            },
                            "required": [
                                "id",
                                "severity"
                            ]
                        }
                    }
                },
                "required": [
                    "name",
                    "vulnerabilities"
                ]
            }
        }
    },
    "oneOf": [
        {
            "required": [
                "vulnerabilities"
            ]
        },
        {
            "required": [
                "dependencies"
            ]
        }
    ]
}